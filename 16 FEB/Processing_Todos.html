<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>JS Task: Processing Todos</title>
    <style>
        body { font-family: sans-serif; padding: 20px; line-height: 1.6; }
        .result-box { background: #f4f4f4; padding: 15px; border-radius: 8px; margin-bottom: 20px; border-left: 5px solid #3498db; }
        h3 { margin-top: 0; color: #2c3e50; }
    </style>
</head>
<body>

    <h1>Todo Analysis Results</h1>
    <div id="completedCount" class="result-box">Counting completed tasks...</div>
    <div id="longTitles" class="result-box">Filtering long titles...</div>
    <div id="mappedArray" class="result-box">Mapping array...</div>

    <script>
        async function processTodos() {
            try {
                // Fetching the data first
                const response = await fetch("https://jsonplaceholder.typicode.com/todos");
                const todos = await response.json();

                // 1. Count how many todos 
                const completedCount = todos.filter(t => t.completed).length;
                document.getElementById('completedCount').innerHTML = 
                    `<h3>1. Completed Tasks</h3> Total: <strong>${completedCount}</strong>`;

                // 2. titles longer than 20 characters
                const longTitles = todos
                    .filter(t => t.title.length > 20)
                    .slice(0, 5); 
                
                let titlesHtml = "<h3>2. Titles > 20 Characters (First 5)</h3><ul>";
                longTitles.forEach(t => titlesHtml += `<li>${t.title}</li>`);
                titlesHtml += "</ul>";
                document.getElementById('longTitles').innerHTML = titlesHtml;

                // 3. {id, titleLength}
                const mappedTodos = todos.map(t => {
                    return { id: t.id, titleLength: t.title.length };
                });
                
                console.log("Mapped Array:", mappedTodos); // View the array in F12 Console
                document.getElementById('mappedArray').innerHTML = 
                    `<h3>3. Mapped Array</h3> Check the <strong>Console (F12)</strong> to see the new array of ${mappedTodos.length} items.`;

            } catch (err) {
                console.error("Error processing task:", err);
            }
        }

        processTodos();
    </script>
</body>
</html>