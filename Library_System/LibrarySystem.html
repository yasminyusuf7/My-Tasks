<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Library Management System</title>
    <style>
        body {
            font-family: sans-serif;
            display: flex;
            justify-content: center;
            align-items: center;
            height: 100vh;
            background-color: #f4f4f9;
        }
        button {
            padding: 15px 30px;
            font-size: 18px;
            cursor: pointer;
            background-color: #4CAF50;
            color: white;
            border: none;
            border-radius: 5px;
        }
    </style>
</head>
<body>

    <button onclick="startSystem()">Open Library Menu</button>

    <script>
        // 1) Create Book Structure
        let library = [];

        const findBookByTitle = (title) => {
            return library.find(book => book.title.toLowerCase() === title.toLowerCase());
        };

        const getBookStatus = (copies) => {
            if (copies > 2) return "Available";
            if (copies >= 1) return "Limited";
            return "Out of Stock";
        };


        function addBook() {
            let title = prompt("Enter Book Title:").trim();
            if (!title) return alert("Error: Book title cannot be empty.");

            let author = prompt("Enter Author Name:").trim();
            let copies = parseInt(prompt("Enter Number of Copies:"));

            if (isNaN(copies) || copies <= 0) {
                return alert("Error: Copies must be a number > 0.");
            }

            let existingBook = findBookByTitle(title);
            if (existingBook) {
                existingBook.availableCopies += copies;
                alert(`Updated: Added ${copies} copies to "${existingBook.title}".`);
            } else {
                library.push({
                    title: title,
                    author: author,
                    availableCopies: copies,
                    borrowedCopies: 0,
                    borrowCount: 0
                });
                alert(`Success: "${title}" added.`);
            }
        }

        function borrowBook() {
            let title = prompt("Enter book title to borrow:");
            let book = findBookByTitle(title);

            if (!book) {
                alert("Error: Book not found.");
            } else if (book.availableCopies === 0) {
                alert("Out of Stock.");
            } else {
                book.availableCopies--;
                book.borrowedCopies++;
                book.borrowCount++;
                alert("Book borrowed successfully!");
            }
        }

        function returnBook() {
            let title = prompt("Enter book title to return:");
            let book = findBookByTitle(title);

            if (book && book.borrowedCopies > 0) {
                book.availableCopies++;
                book.borrowedCopies--;
                alert("Book returned successfully!");
            } else {
                alert("Error: This book cannot be returned.");
            }
        }

        function calculateTotalBooks() {
            let available = 0, borrowed = 0;
            library.forEach(b => {
                available += b.availableCopies;
                borrowed += b.borrowedCopies;
            });
            return { available, borrowed };
        }

        function showReport() {
            if (library.length === 0) return alert("Library is empty.");

            let report = "--- LIBRARY REPORT ---\n";
            library.forEach(book => {
                report += `Title: ${book.title} | Status: ${getBookStatus(book.availableCopies)}\n`;
                report += `Author: ${book.author} | Borrowed: ${book.borrowedCopies}\n`;
                report += `----------------------\n`;
            });

            let totals = calculateTotalBooks();
            report += `\nTotal Available: ${totals.available}\nTotal Borrowed: ${totals.borrowed}`;
            
            console.log(report);
            alert(report);
        }

    
        function startSystem() {
            let running = true;
            while (running) {
                let choice = prompt(
                    "1 → Add New Book\n2 → Borrow Book\n3 → Return Book\n4 → Show Library Report\n5 → Exit"
                );

                switch (choice) {
                    case "1": addBook(); break;
                    case "2": borrowBook(); break;
                    case "3": returnBook(); break;
                    case "4": showReport(); break;
                    case "5": case null: running = false; break;
                    default: alert("Invalid choice.");
                }
            }
        }
    </script>
</body>
</html>